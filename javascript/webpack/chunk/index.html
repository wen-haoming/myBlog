<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.3.7
    </script>
    <title>hash</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/javascript/webpack/chunk" data-show-sidemenu="true" data-show-slugs="false" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" href="/">Ming仔</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>前端<ul><li><a href="/javascript/base">基础</a></li><li><a href="/javascript/business">业务</a></li><li><a href="/javascript/api">浏览器API</a></li><li><a href="/javascript/react">react</a></li><li><a href="/javascript/vue">vue</a></li><li><a aria-current="page" class="active" href="/javascript/webpack">webpack</a></li><li><a href="/javascript/project">项目实践</a></li></ul></span><span>python<ul><li><a href="/python/base">python语言学习</a></li><li><a href="/python/base2">python程序进阶</a></li><li><a href="/python/neuralnetwork">神经网络基础</a></li><li><a href="/python/tensoflow">Tensoflow</a></li></ul></span><span>书籍</span><span>计算机相关<ul><li><a href="/cs/base">基础</a></li></ul></span><span>杂七杂八<ul><li><a href="/order/efficiency">工作效率</a></li><li><a href="/order/think">个人思考</a></li></ul></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" href="/"></a><h1>Ming仔</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>前端<ul><li><a href="/javascript/base">基础</a></li><li><a href="/javascript/business">业务</a></li><li><a href="/javascript/api">浏览器API</a></li><li><a href="/javascript/react">react</a></li><li><a href="/javascript/vue">vue</a></li><li><a aria-current="page" class="active" href="/javascript/webpack">webpack</a></li><li><a href="/javascript/project">项目实践</a></li></ul></li><li>python<ul><li><a href="/python/base">python语言学习</a></li><li><a href="/python/base2">python程序进阶</a></li><li><a href="/python/neuralnetwork">神经网络基础</a></li><li><a href="/python/tensoflow">Tensoflow</a></li></ul></li><li>书籍</li><li>计算机相关<ul><li><a href="/cs/base">基础</a></li></ul></li><li>杂七杂八<ul><li><a href="/order/efficiency">工作效率</a></li><li><a href="/order/think">个人思考</a></li></ul></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/javascript/webpack/base">webpack4基础以及优化方案</a></li><li><a href="/javascript/webpack/principle">webpack 原理</a><ul><li><a href="/javascript/webpack/principle"><span>principle</span></a></li></ul></li><li><a href="/javascript/webpack/sourcemap">sourcemap</a></li><li><a aria-current="page" class="active" href="/javascript/webpack/chunk">hash</a><ul role="slug-list"><li title="hash" data-depth="3"><a href="/javascript/webpack/chunk#hash"><span>hash</span></a></li><li title="chunkhash" data-depth="3"><a href="/javascript/webpack/chunk#chunkhash"><span>chunkhash</span></a></li><li title="contenthash" data-depth="3"><a href="/javascript/webpack/chunk#contenthash"><span>contenthash</span></a></li><li title="结论" data-depth="3"><a href="/javascript/webpack/chunk#结论"><span>结论</span></a></li></ul></li><li><a href="/javascript/webpack/module-federation">moduleFederation</a></li><li><a href="/javascript/webpack/webpack5">webpack5</a></li></ul></div></div><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="关于-webpack-的-文件指纹"><a aria-hidden="true" tabindex="-1" href="/javascript/webpack/chunk#关于-webpack-的-文件指纹"><span class="icon,icon-link"></span></a>关于 webpack 的 文件指纹</h1><p><a target="_blank" rel="noopener noreferrer" href="https://webpack.docschina.org/concepts/under-the-hood/#chunks">官网地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>我们都知道 webpack 的 hash 有三种，分别为 <code>contenthash</code> <code>chunkhash</code> <code>hash</code> 并且这3中 hash 的生成方式不同，所以这三种使需要搭配如何长期缓存。</p><h3 id="hash"><a aria-hidden="true" tabindex="-1" href="/javascript/webpack/chunk#hash"><span class="icon,icon-link"></span></a><code>hash</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">output</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        filename</span><span class="token punctuation">:</span><span class="token string">&#x27;[name]-[hash:5].js&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain">        chunkFilename</span><span class="token punctuation">:</span><span class="token string">&#x27;[name]-[hash:5]-chunk.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        publicPath</span><span class="token punctuation">:</span><span class="token string">&#x27;/dist/&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><blockquote><p><code>filename</code> 代表 main-chunk， <code>chunkFilename</code> 代表 splitChunk 或者 动态 import 后的模块定义的文件名称。</p></blockquote><p>这样设置的效果会导致所有的模块都有对应 hash 值（下图）</p><img width="200" src="/static/hash.88bc15bd.png"/><p>不过只要其中一个代码一处改变，那么打包后的所有文件的 hash <strong>都会发生改变</strong>。</p><h3 id="chunkhash"><a aria-hidden="true" tabindex="-1" href="/javascript/webpack/chunk#chunkhash"><span class="icon,icon-link"></span></a><code>chunkhash</code></h3><p><code>chunkhash</code> 基于 webpack 入口点。定义的每个入口都会拥有自己的哈希值。 如果该特定入口点发生任何变化，则<strong>仅相应的哈希值将发生变化</strong>，但是这样会有另外的<strong>问题</strong>，如果我该 chunk 引入了 css 文件，该 css 文件有变动了，但是该 chunk 的 js 代码没有变动，最后的结果是，css文件和 <code>chunkhash</code> 都改变了。</p><p>当我们打包的时候是这样的（下图）</p><img width="700" src="/static/chunkhash.412e9152.png"/><p>当如果我只修改了 css 文件（下图）</p><img width="700" src="/static/chunkhash2.524fdc90.png"/><p>那么结果很显然，最后是 <code>chunkhash</code>  一起都会被改变，所以在网络上大多数说得人的并不准确。</p><p>但是每次 css 不会触发对应的 <code>chunk</code> 改变有什么方法呢？ 那么就可以使用 接下来的<code>contenthash</code></p><h3 id="contenthash"><a aria-hidden="true" tabindex="-1" href="/javascript/webpack/chunk#contenthash"><span class="icon,icon-link"></span></a><code>contenthash</code></h3><p><code>contenthash</code> 是对于每个对应 <code>chunk</code> 改变，对应的 <code>hash</code> 才会改变，其他 <code>chunk</code> 的 <code>hash</code> 并没有改变，使用 <code>contenthash</code> 能够很好帮助我们配合缓存进行优化QA</p><img width="700" src="/static/contenthash.6d9394b3.png"/><p>当如果我只修改了 css 文件（下图）</p><img width="700" src="/static/contenthash2.138c6ddb.png"/><p>并且在 webpack5 中提供了一个 <code>optimization.realContentHash</code> <a target="_blank" rel="noopener noreferrer" href="https://webpack.docschina.org/configuration/optimization/#optimizationrealcontenthash">链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，当开启后注释的改变和变量名的替换 contenthash 都不会发生改变。</p><h3 id="结论"><a aria-hidden="true" tabindex="-1" href="/javascript/webpack/chunk#结论"><span class="icon,icon-link"></span></a>结论</h3><ol><li>在 <code>output.chunkFilename</code> 中建议使用 <code>contenthash</code> 因为使用这个能够最大限度做缓存策略。</li><li>webpack5 中 <code>optimization.realContentHash = true</code> ，对于 contenthash 进一步优化其功能特性，即使改了注释和变量名也<code>contenthash</code> 不会发生改变。</li></ol></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="最后更新时间：">2/15/2021 13:29:03</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.js"></script>
  </body>
</html>
